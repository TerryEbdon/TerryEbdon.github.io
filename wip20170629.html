<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Developer&#39;s Diary: A mixed bag</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="myStyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="terry_avi.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Developer&#39;s Diary
   </div>
   <div id="projectbrief">Software development, with Terry Ebdon</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('wip20170629.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">A mixed bag </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md61">Excludes in ant filesets</a></li>
<li class="level1"><a href="#autotoc_md62">Errors with setx</a></li>
<li class="level1"><a href="#autotoc_md63">Fixing Eclipse for Groovy</a></li>
<li class="level1"><a href="#autotoc_md64">BitBucket and Mercurial</a></li>
<li class="level1"><a href="#autotoc_md65">Doxygen hates URLs that end with .md</a></li>
<li class="level1"><a href="#autotoc_md66">Interesting web pages</a><ul><li class="level2"><a href="#autotoc_md67">Ant</a></li>
<li class="level2"><a href="#autotoc_md68">Syntax Highlighting</a></li>
<li class="level2"><a href="#autotoc_md70">Groovy</a></li>
<li class="level2"><a href="#autotoc_md71">Mercurial</a></li>
<li class="level2"><a href="#autotoc_md72">Microsoft Windows</a></li>
<li class="level2"><a href="#autotoc_md73">Retro Computing</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="h20170629"></a><em>Thursday 29<sup>th</sup> June, 2017</em></p>
<h1><a class="anchor" id="autotoc_md61"></a>
Excludes in ant filesets</h1>
<p>The excludes section in my backup script is getting quite large:</p>
<div class="fragment"><div class="line">zip( destfile: zipFile ) {</div>
<div class="line">    fileset( dir: <span class="charliteral">&#39;.&#39;</span> ) {</div>
<div class="line">        exclude( name: <span class="stringliteral">&#39;html*/**/*&#39;</span> )</div>
<div class="line">        exclude( name: <span class="stringliteral">&#39;latex*/**/*&#39;</span> )</div>
<div class="line">        exclude( name: <span class="stringliteral">&#39;output/**/*&#39;</span> )</div>
<div class="line">        exclude( name: <span class="stringliteral">&#39;backup/**/*&#39;</span> )</div>
<div class="line">        exclude( name: <span class="stringliteral">&#39;**/*.log&#39;</span> )</div>
<div class="line">        exclude( name: <span class="stringliteral">&#39;**/*.class&#39;</span> )</div>
<div class="line">        exclude( name: <span class="stringliteral">&#39;plantuml.jar&#39;</span> )</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>A list like this should really be in configuration, not code. I can move the excludes into an excludes file. This is more manageable and would make it easy to switch between different exclude lists, if needed. This would be useful for backing up different folder trees with the same code.</p>
<div class="fragment"><div class="line">zip( destfile: zipFile ) {</div>
<div class="line">    fileset(</div>
<div class="line">        dir: <span class="charliteral">&#39;.&#39;</span>,</div>
<div class="line">        excludesfile: <span class="stringliteral">&#39;backupExcludes.txt&#39;</span> )</div>
<div class="line">        <span class="comment">// Hard-coded file name ^^^ Ouch!</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>The <code>backupExcludes.txt</code> file has one pattern per line: </p><div class="fragment"><div class="line">html*/**/*</div>
<div class="line">latex*/**/*</div>
<div class="line">output/**/*</div>
<div class="line">backup/**/*</div>
<div class="line">**/*.log</div>
<div class="line">**/*.class</div>
<div class="line">plantuml.jar</div>
</div><!-- fragment --><p>The hard-coded file name is a bit smelly, let's get rid of it. Currently all configuration for <code>Backup.groovy</code> is in the code, but all other classes use Groovy's <code>ConfigSlurper</code> to load it from <code>config.groovy</code> at run-time.</p>
<p>I've added the excludes file name to <code>config.groovy</code>: </p><div class="fragment"><div class="line">backup {</div>
<div class="line">    excludesFile = <span class="stringliteral">&quot;backupExcludes.txt&quot;</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>The <code>Backup</code> class needs to load the configuration: </p><div class="fragment"><div class="line">def buildConfig</div>
<div class="line"> </div>
<div class="line">Backup() {</div>
<div class="line">    buildConfig = <span class="keyword">new</span> ConfigSlurper().</div>
<div class="line">        parse( <span class="keyword">new</span> File( <span class="stringliteral">&#39;config.groovy&#39;</span> ).</div>
<div class="line">        toURI().toURL() )</div>
<div class="line">}</div>
</div><!-- fragment --><p>Then use it in the FileSet's excludesfile attribute: </p><div class="fragment"><div class="line">zip( destfile: zipFile ) {</div>
<div class="line">    fileset(</div>
<div class="line">        dir: <span class="charliteral">&#39;.&#39;</span>,</div>
<div class="line">        excludesfile: config.backup.excludesFile</div>
<div class="line">    )</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md62"></a>
Errors with setx</h1>
<p>The Windows <code>set</code> command allows environment variables to be created with spaces in the value string. There's no need to escape the spaces or quote the string: </p><div class="fragment"><div class="line">C:&gt;set greeting=Hello world.</div>
<div class="line"> </div>
<div class="line">C:&gt;set greeting</div>
<div class="line">greeting=Hello world.</div>
</div><!-- fragment --><p>Spaces are a problem for the <code>setx</code> command though. Unfortunately <code>setx</code> gives a confusing error message; it's not obvious that the space is the problem: </p><div class="fragment"><div class="line">C:&gt;setx JAVA_HOME c:\Program Files\Java\jdk1.8.0_92 /M</div>
<div class="line">ERROR: Invalid syntax. Default option is not allowed more than &#39;2&#39; time(s).</div>
<div class="line">Type &quot;SETX /?&quot; for usage.</div>
</div><!-- fragment --><p>Surrounding the value with quotation marks solves the problem: </p><div class="fragment"><div class="line">C:&gt;setx JAVA_HOME &quot;c:\Program Files\Java\jdk1.8.0_92&quot; /M</div>
<div class="line"> </div>
<div class="line">SUCCESS: Specified value was saved.</div>
<div class="line"> </div>
<div class="line">C:&gt;</div>
</div><!-- fragment --><p><a class="anchor" id="EclipseOxygen_20170629"></a></p>
<h1><a class="anchor" id="autotoc_md63"></a>
Fixing Eclipse for Groovy</h1>
<p><a class="el" href="wip20170628.html#EclipseOxygen_20170628">Yesterday</a> Eclipse had problems running Groovy projects that use AntBuilder. This was easily fixed. Eclipse is using the embeddable Groovy jar, which doesn't include all the standard libraries. Adding the following three external dependencies to the build path resolves this: - ant-1.9.4.jar - ant-launcher-1.9.4.jar - commons-cli-1.2.jar</p>
<p>The commons-cli-1.2 jar is required to use Groovy's useful CliBuilder class.</p>
<h1><a class="anchor" id="autotoc_md64"></a>
BitBucket and Mercurial</h1>
<p>The WebDoxy project has become non-trivial, so really should be in a cloud-based source control. Time to dust-off my BitBucket account. One advantage of Atlassian BitBucket is support for both Git and Mercurial. I've always used Mercurial as, at least in the past, it was said to have better integration on Microsoft Windows. The machine I'm currently using doesn't have Hg installed, so the combined Mercurial and TortoiseHg package seems the way to go.</p>
<h1><a class="anchor" id="autotoc_md65"></a>
Doxygen hates URLs that end with .md</h1>
<p>I've been trying various versions of <code>[hello world](<a href="https://example.com/hello.md">https://example.com/hello.md</a>)</code>. They all display as <code><a href="https://example.com/hello.md">https://example.com/hello.md</a> "hello world"</code>, where the URL is <b>not</b> rendered as a link. It's very odd. So far I've only seen the link work when it's a straight URL, with no markdown sugar, or the ".md" is removed.</p>
<p>The work-around is to use a HTML anchor.</p>
<h1><a class="anchor" id="autotoc_md66"></a>
Interesting web pages</h1>
<h2><a class="anchor" id="autotoc_md67"></a>
Ant</h2>
<ul>
<li><a href="https://ant.apache.org/manual/Types/fileset.html">Ant FileSet</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md68"></a>
Syntax Highlighting</h2>
<ul>
<li><a href="http://pygments.org/">Pygments</a> &ndash; Python syntax highlighter.</li>
<li><a href="http://benfoster.io/blog/embed-bitbucket-source-code-on-your-website">How to embed Bitbucket source code on your Website</a></li>
<li><a href="https://github.com/google/code-prettify">google/code-prettify</a> &ndash; An embeddable script that makes source-code snippets in HTML prettier.</li>
<li><a href="https://github.com/google/code-prettify/blob/master/docs/getting_started.md">Getting Started with Google code-prettify</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md70"></a>
Groovy</h2>
<ul>
<li><a href="https://6by9.wordpress.com/2011/01/31/why-you-should-never-set-groovy_home/">Why You Should Never Set GROOVY_HOME</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md71"></a>
Mercurial</h2>
<ul>
<li><a href="https://www.mercurial-scm.org/wiki/Download">Mercurial downloads</a></li>
<li><a href="https://bitbucket.org/mercurialeclipse/main/wiki/Home">MercurialEclipse</a> &ndash; Eclipse plug-in for Mercurial.</li>
<li><a href="https://www.mercurial-scm.org/wiki/WorkingPractices">Mercurial Working Practices</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md72"></a>
Microsoft Windows</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/17215562/invalid-syntax-with-setx">Invalid syntax with setx</a> &ndash; stack overflow.</li>
</ul>
<h2><a class="anchor" id="autotoc_md73"></a>
Retro Computing</h2>
<ul>
<li><a href="http://docs.cslabs.clarkson.edu/wiki/Developing_for_a_PDP-11">Developing for a PDP-11</a></li>
<li><a href="http://www.wolfgang-houben.de/faqpdp11.htm">The PDP-11 FAQ</a></li>
<li><a href="http://www.ibiblio.org/pub/academic/computer-science/history/pdp-11/">PDP-11 Freeware Archives</a><ul>
<li><a href="http://www.ibiblio.org/pub/academic/computer-science/history/pdp-11/games/">PDP-11 Games</a> &ndash; includes advent.sav!</li>
</ul>
</li>
<li><a href="http://dmv.net/dec/index2.htm">RSTS/E v9.7 Documentation</a> &ndash; downloads from dmv.net. Also includes RSX-11M-Plus docs and various hardware technical manuals.</li>
</ul>
<p> 
<hr/>
<a class='btn' href='wip20170628.html'>28<sup>th</sup> June 👈</a>
<a class='btn' href='#h20170629'>Top of page</a>
<a class='btn' href='wip20170630.html'>👉 30<sup>th</sup> June</a>
 <span class="copyright">&copy; 2017 <a href="AboutMe.html" title="Terry Ebdon">Terry Ebdon.</a></span><br  />
<p>Find me coding on <a title="terry_ebdon on BitBucket"
href="https://github.com/TerryEbdon">GitHub,</a> networking on <a
title="Terry Ebdon on LinkedIn"
href="https://www.linkedin.com/in/talent/">LinkedIn</a> and hanging out on <a
title="@terry_ebdon" href="https://twitter.com/@terry_ebdon">twitter.</a> </p>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jul 20 2020 15:56:10 for Developer&#39;s Diary by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
